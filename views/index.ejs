<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title><%= title %></title>
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<link rel="stylesheet" href="/style/estilo.css">
</head>
<body>
	<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
      <!-- We use the fluid option here to avoid overriding the fixed width of a normal container within the narrow content columns. -->
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-6">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Contabilidad</a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-6">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#">Registros contables</a></li>
            <li><a href="#">Reporte</a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div>
    </nav>
	
	<div class="container">
		<div class="col-md-12">
		<div class="jumbotron">
			  <div class="container">
			  	<h2>Administracion de cuenta</h2>

			  	<button type"button" class="btn btn-default" id="agregarCuenta">Agregar Cuenta</button>
			    <table class="table">
			      <thead>
			        <tr>
			          <th>Nombre</th>
			          <th>Tipo</th>
			          <th>Transacciones</th>
			          <th>Nivel</th>
			          <th>Mayor</th>
			          <th>Balance</th>
			          <th>Estado</th>
			          <th>Acciones</th>
			        </tr>
			      </thead>
			      <tbody>
			      	<% data.forEach(function(cuentas){


			      	 %>
			        <tr>
			          <td><%= cuentas.Descripcion%></td>
			          <td><%= cuentas.TipoCuenta %></td>
			          <td><%= cuentas.Trans %></td>
			          <td><%= cuentas.Nivel %></td>
			          <td><%= cuentas.CuentaMayor %></td>
			          <td><%= cuentas.Balance %></td>
			          <td><%= cuentas.Estado %></td>
			          <td>
			          	
			          	<div class="dropdown">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
   
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
    <li role="presentation"><a role="menuitem" tabindex="-1" onclick="editar('<%= cuentas.ID %>')">Editar cuenta</a></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" onclick="eliminar('<%= cuentas.ID %>')">Borrar cuenta</a></li>

  </ul>
</div>
			          </td>
			          

			        </tr>
			        <% }); %>
			      </tbody>
			    </table>
  </div>
			  
			</div>

		</div>

	</div>
	<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      <h2 class="modal-title" id="myModalLabel">Agregar Cuenta</h2>
      <div class="modal-body">



		<form id="formularioJohn" class="bs-example bs-example-form" role="form">

			 <div class="input-group" id="editarID" style="display: none;">
      <span class="input-group-addon">ID</span>
      <input type="text" id="id" class="form-control" disabled>
    </div>

    <br> 

    <div class="input-group">
      <span class="input-group-addon">Descripcion</span>
      <input type="text" id="descripcion" class="form-control" placeholder="Descripcion">
    </div>
    <br>    

    <div class="input-group">
      <span class="input-group-addon">Tipo de Cuenta</span>
      <select id="tipoCuenta" class="form-control" >
		<option value="1">Activo</option>
		<option value="2">Pasivo</option>
      </select>
    </div>
    <br>    

    <div class="input-group">
      <span class="input-group-addon">Acepta transacciones?</span>
      <select id="transaccion" class="form-control" >
		<option value="1">Si</option>
		<option value="2">No</option>
      </select>
    </div>
	
	<br>
    <div class="input-group">
      <span class="input-group-addon">Nivel</span>
      <select id="nivel" class="form-control" >
		<option value="1">1</option>
		<option value="2">2</option>
		<option value="3">3</option>
      </select>
    </div>

	<br>

    <div class="input-group">
      <span class="input-group-addon">Es una cuenta Mayor?</span>
      <select id="cuentaMayor" class="form-control" >
		<option value="1">Si</option>
		<option value="2">No</option>
      </select>
    </div>

	<br>

	<div class="input-group">
      <span class="input-group-addon">Balance</span>
      <input type="text" class="form-control" id="balance" placeholder="Balance">
    </div>

    <br>
	<div class="input-group">
      <span class="input-group-addon">Estado</span>
      <select id="estado" class="form-control" >
		<option value="1">Activo</option>
		<option value="0">Inactivo</option>
      </select>
    </div>
    <br>
      <div class="guardarCuenta">
        <button type="button" id="guardarCuenta" class="btn btn-danger" >Crear Cuenta</button>
        
      </div>

      <div class="actualizarCuenta"  style="display:none;">
      	<button type="button" id="actualizarCuenta" class="btn btn-danger" >Actualizar Cuenta</button>
      </div>
    <br>
    
  </form>
	
	<div id="cuentaEliminada"  style="display:none;">
				  		
				  	</div>

      	</div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger " data-dismiss="modal">Close</button>
        
      </div>
      </div>
  </div>
</div>

<script type="text/javascript" src="jquery.js"></script>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script>
	$(document).ready(function(){
		$("#agregarCuenta").click(function(){
			$("h2.modal-title").text("Agregar Cuenta");
			$("#myModal").modal('show');			  	
		  	$("#cuentaEliminada").hide("fast");
		  	$("#formularioJohn").show("fast");

		});

		$("#guardarCuenta").click(function(){


			var descripcion = $("#descripcion").val();
			var tipoCuenta  = $("#tipoCuenta").val();
			var transaccion = $("#transaccion").val();      
			var nivel       = $("#nivel").val();	
			var cuentaMayor = $("#cuentaMayor").val();     
			var balance     = $("#balance").val(); 
			var estado      = $("#estado").val();

			$.ajax({
							type: "POST",
						  url: "/agregar",
						  data: { descripcion: descripcion, tipoCuenta: tipoCuenta, transaccion: transaccion,  nivel: nivel, cuentaMayor:cuentaMayor, balance: balance, estado: estado }
						}).done(function(msg) {
						  	$("#formularioJohn").html(msg);
						});

		});


		$("#actualizarCuenta").click(function(){

			var id = $("#id").val();
			var descripcion = $("#descripcion").val();
			var tipoCuenta  = $("#tipoCuenta").val();
			var transaccion = $("#transaccion").val();      
			var nivel       = $("#nivel").val();	
			var cuentaMayor = $("#cuentaMayor").val();     
			var balance     = $("#balance").val(); 
			var estado      = $("#estado").val();

			

			$.ajax({
							type: "POST",
						  url: "/editar",
						  data: { id: id, descripcion: descripcion, tipoCuenta: tipoCuenta, transaccion: transaccion,  nivel: nivel, cuentaMayor:cuentaMayor, balance: balance, estado: estado }
						}).done(function(msg) {
						  	$("#formularioJohn").html(msg);
						});

		});



	});	

		function editar(id){

			$("#editarID").show();
			$("#id").val(id);

			$.ajax({
				type:"POST",
				url: "/getCuenta",
				data: {id: id}

				}).done(function(data){


					$("#descripcion").val(data[0].Descripcion);
					$("#tipoCuenta").val(data[0].TipoCuenta);

			$("h2.modal-title").text("Editar Cuenta");
			$("#myModal").modal('show');			  	
		  	$("#cuentaEliminada").hide("fast");
		  	$("#formularioJohn").show("fast");

		  	$(".guardarCuenta").hide();
		  	$(".actualizarCuenta").show();

				});



		}

	function eliminar(id)
		{
			$.ajax({
				type:"POST",
				url: "/eliminar",
				data: {id: id}

				}).done(function(msg){
					
					$("h2.modal-title").text(msg);
							$("#cuentaEliminada").html(msg);
						  	$("#myModal").modal('show');
						  	$("#formularioJohn").hide("fast");
							$("#cuentaEliminada").show("fast");
				});

		}



		</script>


	
</body>
</html>